import gmpy2
from Crypto.Util.number import long_to_bytes
c1 = 9977992111543474765993146699435780943354123551515555639473990571150196059887059696672744669228084544909025528146255490100789992216506586730653100894938711107779449187833366325936098812758615334617812732956967746820046321447169099942918022803930068529359616171025439714650868454930763815035475473077689115645913895433110149735235210437428625515317444853803605457325117693750834579622201070329710209543724812590086065816764917135636424809464755834786301901125786342127636605411141721732886212695150911960225370999521213349980949049923324623683647865441245309856444824402766736069791224029707519660787841893575575974855
n1 = 15653165971272925436189715950306169488648677427569197436559321968692908786349053303839431043588260338317859397537409728729274630550454731306685369845739785958309492188309739135163206662322980634812713910231189563194520522299672424106135656125893413504868167774287157038801622413798125676071689173117885182987841510070517898710350608725809906704505037866925358298525340393278376093071591988997064894579887906638790394371193617375086245950012269822349986482584060745112453163774290976851732665573217485779016736517696391513031881133151033844438314444107440811148603369668944891577028184130587885396017194863581130429121
n2 = 16489315386189042325770722192051506427349661112741403036117573859132337429264884611622357211389605225298644036805277212706583007338311350354908188224017869204022357980160833603890106564921333757491827877881996534008550579568290954848163873756688735179943313218316121156169277347705100580489857710376956784845139492131491003087888548241338393764269176675849400130460962312511303071508724811323438930655022930044289801178261135747942804968069730574751117952892336466612936801767553879313788406195290612707141092629226262881229776085126595220954398177476898915921943956162959257866832266411559621885794764791161258015571
key_encode = 154190230043753146353030548481259824097315973300626635557077557377724792985967471051038771303021991128148382608945680808938022458604078361850131745923161785422897171143162106718751785423910619082539632583776061636384945874434750267946631953612827762111005810457361526448525422842867001928519321359911975591581818207635923763710541026422076426423704596685256919683190492684987278018502571910294876596243956361277398629634060304624160081587277143907713428490243383194813480543419579737033035126867092469545345710049931834620804229860730306833456574575819681754486527026055566414873480425894862255077897522535758341968447477137256183708467693039633376832871571997148048935811129126086180156680457571784113049835290351001647282189000382279868628184984112626304731043149626327230591704892805774286122197299007823500636066926273430033695532664238665904030038927362086521253828046061437563787421700166850374578569457126653311652359735584860062417872495590142553341805723610473288209629102401412355687033859617593346080141954959333922596227692493410939482451187988507415231993
e1 = 125794
e2 = 42373
enc = 17403902166198774030870481073653666694643312949888760770888896025597904503707411677223946079009696809
p = gmpy2.gcd(n1, n2)
q = n1 / p
r = n2 / p
phi = (p - 1) * (q - 1)
d = gmpy2.invert(e1 / 2, phi)
s_2 = pow(c1, d, n1)
m_p = pow(s_2, (p + 1) / 4, p)
m_q = pow(s_2, (q + 1) / 4, q)
g, y_p, y_q = gmpy2.gcdext(p, q)
s = [1,1,1,1]
s[0] = (y_p * p * m_q + y_q * q * m_p) % n1
s[1] = n1 - s[0]
s[2] = (y_p * p * m_q - y_q * q * m_p) % n1
s[3] = n1 - s[2]
for i in s:
    n3 = p * q * i
    r = (p - 1) * (q - 1) * (i - 1)
    d2 = gmpy2.invert(e2, r)
    key = pow(key_encode, int(d2), n3)
    dec = enc ^ key
    mask = int('1' * 335, 2)
    mask_low = int('1' * 200, 2)
    source_low = (dec ^ 0) & mask_low
    source_high = ((source_low << 200) ^ dec) & mask
    source_high >>= 200
    source_high <<= 200
    source = source_high | source_low
    print long_to_bytes(source)
    